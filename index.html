<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        #text,
        #file {
            width: 90%;
        }

        body {
            align-items: center;
        }
    </style>
    <script src="//cdn.jsdelivr.net/npm/eruda"></script>
    <script>
        eruda.init();
    </script>
    <title>Dao3 Static 工具</title>
</head>

<body>
    在这里输入上传的文本: <br>
    <textarea id="text" cols="30" rows="10"></textarea><br>
    <button onclick="postText()">上传文本</button><br>
    上传文件: <br>
    <input type="file" multiple="false" id="file" onchange="postFile()"><br>
    上传结果: <br>
    <code id="result"></p>
    <script>
        const resultDisplay = document.getElementById("result");
        async function post(data) {
            const postResult = await fetch("https://static.dao3.fun/block/", {
                method: "POST",
                headers: {},
                body: data,
                mode: "cors"
            });
            const resultData = await postResult.json();
            if (resultData.Key) {
                const hash = resultData.Key;
                resultData.textContent = `https://static.dao3.fun/block${hash}.json`;
            } else {
                resultDisplay.textContent = JSON.stringify(resultData);
            }
        }
        async function postFile() {
            const input = document.getElementById("file");
            const file = input.files[0];
            await post(file);
        };
        async function postText() {
            const text = document.getElementById("text");
            const data = text.value;
            if (data.length === 0) return;
            await post(data);
        }
    </script>
</body>

</html>